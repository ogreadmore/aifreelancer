<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gemini Fan - Latest News on Google Gemini</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        /* Use the Inter font family */
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Simple animation for card fade-in */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .news-card {
            animation: fadeIn 0.5s ease-out forwards;
        }
    </style>
</head>
<body class="bg-gray-50 dark:bg-gray-900 text-gray-800 dark:text-gray-200">

    <!-- Header Section -->
    <header class="bg-white dark:bg-gray-800/50 shadow-sm sticky top-0 backdrop-blur-lg z-10">
        <div class="container mx-auto px-4 py-4">
            <h1 class="text-3xl font-bold text-center text-transparent bg-clip-text bg-gradient-to-r from-blue-500 to-purple-600 dark:from-blue-400 dark:to-purple-500">
                GeminiFan.com
            </h1>
            <p class="text-center text-gray-500 dark:text-gray-400 mt-1">Your daily source for the latest news on Google Gemini</p>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto p-4 md:p-8">

        <!-- News Container -->
        <div id="news-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- News articles will be injected here by JavaScript -->
        </div>

        <!-- Loading Indicator -->
        <div id="loading-indicator" class="text-center py-12 hidden">
            <svg class="animate-spin h-8 w-8 text-blue-500 mx-auto" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
            <p class="mt-4 text-lg font-medium text-gray-600 dark:text-gray-400">Fetching the latest Gemini news...</p>
        </div>
        
        <!-- Error Message -->
        <div id="error-message" class="text-center py-12 hidden">
             <div class="max-w-md mx-auto p-6 bg-red-100 dark:bg-red-900/50 border border-red-400 dark:border-red-700 rounded-lg">
                <h3 class="text-lg font-semibold text-red-800 dark:text-red-200">Something Went Wrong</h3>
                <p id="error-text" class="mt-2 text-red-600 dark:text-red-300">Could not fetch news. Please check your network connection.</p>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="text-center py-6 mt-8 border-t border-gray-200 dark:border-gray-800">
        <p class="text-gray-500 dark:text-gray-400">News sourced from <a href="https://news.google.com/" target="_blank" rel="noopener noreferrer" class="text-blue-500 hover:underline">Google News</a></p>
    </footer>

    <script>
        // DOM Elements
        const newsContainer = document.getElementById('news-container');
        const loadingIndicator = document.getElementById('loading-indicator');
        const errorMessage = document.getElementById('error-message');
        const errorText = document.getElementById('error-text');

        /**
         * Fetches and parses the Google News RSS feed.
         */
        async function fetchNews() {
            // Clear previous state and show loader
            newsContainer.innerHTML = '';
            errorMessage.classList.add('hidden');
            loadingIndicator.classList.remove('hidden');

            // Construct Google News RSS feed URL for the search query
            const searchQuery = encodeURIComponent('"Google Gemini" OR "Gemini AI"');
            const googleNewsUrl = `https://news.google.com/rss/search?q=${searchQuery}&hl=en-US&gl=US&ceid=US:en`;
            
            // Use a different, more reliable CORS proxy to bypass browser restrictions
            const proxyUrl = `https://thingproxy.freeboard.io/fetch/${googleNewsUrl}`;

            try {
                const response = await fetch(proxyUrl);
                if (!response.ok) {
                    throw new Error(`Network response was not ok. Status: ${response.status}`);
                }
                
                // This proxy returns raw text, not JSON, so we use .text()
                const xmlText = await response.text();
                
                // Parse the XML feed from the text response
                const parser = new DOMParser();
                const xmlDoc = parser.parseFromString(xmlText, "application/xml");
                
                // Check for parsing errors which can happen if the proxy fails
                const parseError = xmlDoc.querySelector('parsererror');
                if (parseError) {
                    console.error('XML Parse Error:', parseError);
                    throw new Error('Failed to parse the news feed. The proxy may be down or returning an error page.');
                }
                
                const items = xmlDoc.querySelectorAll('item');
                if (items.length > 0) {
                    // Map RSS items to a more usable article object structure
                    const articles = Array.from(items).map(item => {
                        const descriptionHTML = item.querySelector('description').textContent;
                        const tempDiv = document.createElement('div');
                        tempDiv.innerHTML = descriptionHTML;

                        // Extract image URL and a cleaner description from the HTML content
                        const imageUrl = tempDiv.querySelector('img')?.src || null;
                        const description = tempDiv.innerText.split(']')[1] || tempDiv.innerText || 'No description available.';

                        return {
                            title: item.querySelector('title').textContent,
                            link: item.querySelector('link').textContent,
                            description: description.trim(),
                            urlToImage: imageUrl,
                            publishedAt: item.querySelector('pubDate').textContent,
                            source: {
                                name: item.querySelector('source').textContent
                            }
                        };
                    });
                    displayArticles(articles);
                } else {
                    showError('No articles found in the Google News RSS feed.');
                }

            } catch (error) {
                console.error('Error fetching or parsing RSS feed:', error);
                showError(`Failed to fetch news. ${error.message}`);
            } finally {
                // Always hide the loading indicator
                loadingIndicator.classList.add('hidden');
            }
        }

        /**
         * Displays the fetched articles on the page.
         * @param {Array} articles - An array of article objects.
         */
        function displayArticles(articles) {
            newsContainer.innerHTML = ''; // Clear previous articles or loading indicators
            articles.forEach(article => {
                const articleCard = document.createElement('div');
                articleCard.className = 'news-card bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden hover:shadow-xl transition-shadow duration-300 flex flex-col';
                
                const imageUrl = article.urlToImage || `https://placehold.co/600x400/2B6CB0/FFFFFF?text=${encodeURIComponent(article.source.name)}`;

                articleCard.innerHTML = `
                    <a href="${article.link}" target="_blank" rel="noopener noreferrer">
                        <img src="${imageUrl}" alt="" class="w-full h-48 object-cover" onerror="this.onerror=null;this.src='https://placehold.co/600x400/4A5568/FFFFFF?text=Image+Not+Found';this.alt='Image not available';">
                    </a>
                    <div class="p-5 flex flex-col flex-grow">
                        <h2 class="text-xl font-bold mb-2 flex-grow">
                            <a href="${article.link}" target="_blank" rel="noopener noreferrer" class="hover:text-blue-600 dark:hover:text-blue-400 transition-colors">
                                ${article.title}
                            </a>
                        </h2>
                        <p class="text-gray-600 dark:text-gray-400 mb-4 text-sm">${article.description}</p>
                        <div class="mt-auto pt-4 text-xs text-gray-500 dark:text-gray-400 border-t border-gray-100 dark:border-gray-700">
                            <span class="font-semibold">${article.source.name}</span> &bull; <span>${new Date(article.publishedAt).toLocaleDateString()}</span>
                        </div>
                    </div>
                `;
                newsContainer.appendChild(articleCard);
            });
        }
        
        /**
         * Shows an error message on the UI.
         * @param {string} message - The error message to display.
         */
        function showError(message) {
            errorText.textContent = message;
            errorMessage.classList.remove('hidden');
        }

        // --- Initial Load ---
        // Fetch news as soon as the page loads.
        window.addEventListener('load', fetchNews);

    </script>
</body>
</html>
